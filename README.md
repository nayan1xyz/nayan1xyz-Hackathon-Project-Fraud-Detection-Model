# ISO 20022 Fraud Detection System

A prototype fraud detection system built to identify suspicious financial transactions based on the ISO 20022 standard. This project demonstrates the entire workflow—from synthetic data generation, data preprocessing, and model training to deploying a Flask API that provides a binary fraud prediction and an ML-based risk score using `predict_proba`.

---

## Table of Contents

- [Overview](#overview)
- [Features](#features)
- [Project Structure](#project-structure)
- [Installation](#installation)
- [Usage](#usage)
  - [1. Generate Synthetic Data](#1-generate-synthetic-data)
  - [2. Data Preprocessing](#2-data-preprocessing)
  - [3. Model Training](#3-model-training)
  - [4. Running the API](#4-running-the-api)
- [API Documentation](#api-documentation)
  - [Endpoint: /predict](#endpoint-predict)
  - [Sample Request](#sample-request)
  - [Sample Response](#sample-response)
- [Project Flow](#project-flow)
- [Future Enhancements](#future-enhancements)
- [License](#license)

---

## Overview

This project is a multi-step approach to detect fraudulent transactions that may indicate money laundering. The key components are:

- **Synthetic Data Generation:**  
  Generate ISO 20022 compliant transactions (both fraudulent and non-fraudulent) and save them as JSON.
  
- **Data Preprocessing:**  
  Extract features from the JSON data (e.g., transaction amount, high-risk country flag, sanctioned entity flag, regulatory code flag, and amount risk flag), scale the features, and save the processed data.
  
- **Model Training:**  
  Train a Random Forest classifier on the preprocessed data to classify transactions as fraudulent or safe.
  
- **API Deployment:**  
  Deploy a Flask API that accepts ISO 20022 JSON transactions, processes the input, and returns a binary fraud prediction along with an ML-based risk score (calculated using the model’s `predict_proba` method).

---

## Features

- **Synthetic Data Generation:**  
  Simulates realistic ISO 20022 transactions with fraud labels.
  
- **Feature Engineering:**  
  Extracts and engineers key features:
  - `transaction_amount`
  - `high_risk_country` (flagged if the IBAN starts with high-risk prefixes like "NG", "IR", or "SY")
  - `sanctioned_entity` (flagged if the debtor's ID is blacklisted)
  - `regulatory_code` (flagged if the regulatory reporting code is "AML")
  - `amount_risk` (flagged if the transaction amount exceeds $5000)
  
- **Machine Learning:**  
  Uses a Random Forest classifier to detect fraud and computes a risk score based on the fraud probability.
  
- **RESTful API:**  
  A Flask API that processes incoming ISO 20022 transactions and returns a prediction along with a risk score.

---

## Project Structure
```
.
├── generate_synthetic_data.py      # Script to generate synthetic ISO 20022 transaction data
├── datapreprocessing.py            # Script to extract features, scale data, and save the preprocessed dataset and scaler
├── train_model.py                  # Script to train the Random Forest fraud detection model
├── fraud_api.py                    # Flask API for real-time fraud prediction and risk scoring
├── transactions.json               # Synthetic transaction data generated by generate_synthetic_data.py
├── preprocessed_transactions.csv   # Preprocessed dataset from datapreprocessing.py
├── scaler.pkl                      # Scaler object saved from datapreprocessing.py
├── iso20022_fraud_model.pkl        # Trained machine learning model saved from train_model.py
└── README.md                       # This README file
```

## Setup Instructions
### Prerequisites
Ensure you have the following installed:
- Python 3.x
- Required dependencies from `requirements.txt` (if applicable)

### Installation
1. Clone the repository:
   ```bash
   git clone <repository-url>
   cd <repository-directory>
   ```
2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

## Usage
### Step 1: Generate Synthetic Data
Run the script to generate synthetic transaction data:
```bash
python generate_synthetic_data.py
```
This will create `transactions.json` with synthetic ISO 20022 transaction data.

### Step 2: Preprocess Data
Extract features, scale data, and save the processed dataset:
```bash
python datapreprocessing.py
```
This will generate `preprocessed_transactions.csv` and `scaler.pkl`.

### Step 3: Train the Fraud Detection Model
Train the Random Forest model using the preprocessed data:
```bash
python train_model.py
```
The trained model will be saved as `iso20022_fraud_model.pkl`.

### Step 4: Run the Fraud Detection API
Start the Flask API for real-time fraud detection:
```bash
python fraud_api.py
```
The API will be accessible at `http://127.0.0.1:5000/`.

## API Endpoints
### Predict Fraud
**Endpoint:** `POST /predict`
- **Input:** JSON object with transaction details
- **Output:** Fraud prediction and risk score

Example request:
```json
{
  "transaction_amount": 5000,
  "sender_country": "US",
  "receiver_country": "IN",
  "transaction_type": "wire_transfer"
}
```

Example response:
```json
{
  "is_fraud": true,
  "risk_score": 0.85
}
```

## Acknowledgments
- This project uses the Random Forest algorithm for fraud detection.
- Flask is used to deploy the fraud detection model as an API.

## Thankyou
Made with ❤

